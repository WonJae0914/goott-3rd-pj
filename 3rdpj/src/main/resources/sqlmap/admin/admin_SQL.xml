<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="admin">

<select id="login_check" resultType="com.goott.pj3.admin.dto.AdminUserDTO">
      select user_id, auth, pw
        from user
       where user_id = #{user_id}
         and pw = #{pw}
         and auth = 'auth_a'
</select>

<select id="noticelist" resultType="com.goott.pj3.admin.dto.NoticeDTO">
	select qna_idx, user_id, category, auth, qna_title, qna_content, q_del_yn, create_date, update_date
	  from qna
	  where category="N"
</select>

<insert id="noticeinsert">
	insert into qna(user_id, category, auth, qna_title,qna_content , create_date)
	VALUES (#{user_id}, #{category}, #{auth}, #{qna_title}, #{qna_content}, current_timestamp)
</insert>

<select id="noticedetail" parameterType="int" resultType="com.goott.pj3.admin.dto.NoticeDTO">
	select qna_idx, user_id, category, auth, qna_title, qna_content, q_del_yn, update_date
	  from qna
	 where qna_idx=#{qna_idx}
</select>

<update id="noticeupdate">
	update qna
	   set qna_title=#{qna_title}, qna_content=#{qna_content}, update_date=NOW()
	 where qna_idx=#{qna_idx}
</update>

<delete id="noticedelete">
	update qna 
	   set q_del_yn='Y', update_date=NOW()
	 where qna_idx=#{qna_idx}
</delete>

<delete id="noticedeletere">
	update qna 
	   set q_del_yn='N', update_date=NOW()
	 where qna_idx=#{qna_idx}
</delete>

<select id="adminuserlist" resultType="com.goott.pj3.admin.dto.AdminUserDTO">
	select user_id, pw, email, hp, auth, u_del_yn, u_point, create_date, update_date
	  from user
	 where auth != 'auth_a'
</select>

<select id="adminuserdetail" resultType="com.goott.pj3.admin.dto.AdminUserDTO">
	select 
        user_id, pw, birth, email, hp, hp_emp, intro, 
        profile_img, auth, u_del_yn, u_point, emp_num, 
        success_count, planner_like, planner_unlike, acount, 
        create_date, update_date
    from 
        user
    where 
        user_id = #{user_id}
</select>

<update id="adminuserupdate">
	update user
	   set pw=#{pw}, birth=#{birth}, email=#{email}, hp=#{hp}, hp_emp=#{hp_emp}, intro=#{intro}, 
        profile_img=#{profile_img}, auth=#{auth}, u_del_yn=#{u_del_yn}, u_point=#{u_point}, emp_num=#{emp_num}, 
        success_count=#{success_count}, planner_like=#{planner_like}, planner_unlike=#{planner_unlike}, acount=#{acount}, 
        update_date=NOW()
	 where user_id=#{user_id}
</update>

<delete id="adminuserdelete">
	update user 
	   set u_del_yn='y'
	 where user_id=#{user_id}
</delete>

<update id="adminuserdeletere">
	update user
	   set u_del_yn='n'
	 where user_id=#{user_id}
</update>

</mapper>